# AI作業チェックリスト

このドキュメントは、AIアシスタント（私）が作業を開始する前に必ず確認すべき項目をまとめたものです。

---

## 🔍 作業開始前の必須確認事項

### 1. **現在の作業ディレクトリを確認**

```powershell
Get-Location
```

**期待される結果**:
```
C:\Users\mituo\Desktop\kaede
```

**⚠️ 注意**:
- `C:\Users\mituo\.cursor\worktrees\kaede\*` の場合は**ワークツリー**
- ワークツリーで修正しても、実際のサーバーには反映されない

**対処法**:
- ユーザーに確認する
- または、実際の動作ディレクトリ（`C:\Users\mituo\Desktop\kaede`）を特定して、そこで作業する

---

### 2. **サーバーの動作状態を確認**

ターミナルファイルを確認：
```
C:\Users\mituo\.cursor\projects\c-Users-mituo-Desktop-kaede\terminals\1.txt
```

**確認項目**:
- `cwd:` (current working directory) がどこか
- サーバーが実際に動いているディレクトリを特定

---

### 3. **問題の種類を特定**

| 症状 | 原因 | 修正ファイル |
|-----|------|------------|
| AIの返答内容がおかしい | バックエンド | `functions\_lib\characters\*.js` |
| ボタンが表示されない | フロントエンド | `public\js\features\*.js` |
| ボタンが動作しない | フロントエンド | `public\js\features\*.js` |
| AIは正しいが画面が動かない | フロントエンド | `public\js\features\*.js` |
| キーワード検出がおかしい | フロントエンド | `public\js\features\*.js` |

---

### 4. **修正前にログで原因を確認**

**原則**: **修正前に必ず原因を特定する**

**手順**:
1. ブラウザのコンソールログを確認
2. 以下を特定：
   - AIの返答全文
   - 検出されたキーワード
   - sessionStorage の状態
3. 原因がバックエンドかフロントエンドかを判定
4. 必要であれば、デバッグログを追加して原因を追跡

**❌ やってはいけないこと**:
- 原因不明のまま修正を加える
- 「たぶんこれが原因だろう」という推測で修正する

---

### 5. **修正後の確認**

- [ ] ブラウザでハードリロード (`Ctrl + Shift + R`) を案内
- [ ] ログが正しく表示されるか確認
- [ ] 期待される動作になっているか確認

---

## 📂 ファイル構成の理解

### バックエンド（AIの振る舞い）

**場所**: `functions\_lib\characters\*.js`

**例**: `yukino.js`
- 雪乃の性格設定
- 「次は現在のカードをめくってみましょうね」というフレーズ
- カードの解説内容
- まとめ鑑定の内容

**修正が必要な場合**:
- AIの返答が間違っている
- 話し方を変更したい
- 鑑定の内容を変更したい

---

### フロントエンド（UIの動作）

**場所**: `public\js\features\*.js`

**例**: `yukino-tarot.js`
- タロットカードの画像表示
- ボタンの表示・クリック動作
- AIの返答から「次は現在のカード」を検出
- 次のカードへ進むロジック
- sessionStorage でカード情報を管理

**修正が必要な場合**:
- ボタンが表示されない
- カードがめくれない
- AIの返答を正しく検出できていない
- アニメーションがおかしい

---

## 🎯 今回の教訓（2024年12月）

### 問題
- 未来のカードが連続で出現する

### 原因
1. **ワークツリーと実際の動作ディレクトリを混同**
   - ワークツリーで修正していたため、実際のサーバーには反映されなかった
2. **原因を特定せずに修正を試みた**
   - AIの問題か、フロントエンドの問題かを特定しないまま修正しようとした

### 対策
1. 作業開始前に必ず動作ディレクトリを確認
2. 修正前に必ずログで原因を特定
3. デバッグログを追加して、AIの返答とフロントエンドの検出を追跡

---

## ✅ 作業開始前のチェックリスト

- [ ] `Get-Location` で現在のディレクトリを確認
- [ ] ワークツリーではなく、メインリポジトリで作業している
- [ ] サーバーの動作ディレクトリを特定した
- [ ] 問題の種類を特定した（バックエンド/フロントエンド）
- [ ] ブラウザのコンソールでログを確認した
- [ ] 原因を特定してから修正を開始する




