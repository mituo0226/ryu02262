-- ============================================
-- conversation_profileカラムの追加
-- 過去100通までの会話内容から抽出したプロフィール情報を保存
-- ============================================

-- usersテーブルにconversation_profileカラムを追加
-- 注意: 既存のusersテーブルがある場合は、このマイグレーションを実行してください
ALTER TABLE users ADD COLUMN conversation_profile TEXT;

-- インデックスは不要（usersテーブルの主キーで検索するため）

-- ============================================
-- 説明
-- ============================================
-- conversation_profile: 過去100通までの会話内容から抽出したプロフィール情報
-- - 登録ユーザーのチャット履歴は最新10通のみ保存
-- - 10通を超える古いメッセージは削除される
-- - 削除前に、100通までの会話内容からプロフィール情報を抽出してこのカラムに保存
-- - このプロフィール情報は、最新10通の会話履歴と合わせて、会話の継続性を保つために使用される


