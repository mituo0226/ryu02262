<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>API„Ç®„É©„ÉºË®∫Êñ≠</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #f5f5f5; }
        pre { background: white; padding: 20px; border-radius: 5px; overflow-x: auto; border: 1px solid #ccc; }
        h2 { color: #333; margin-top: 20px; }
        .error { color: red; background: #ffe6e6; padding: 10px; border-radius: 3px; }
        .success { color: green; background: #e6ffe6; padding: 10px; border-radius: 3px; }
    </style>
</head>
<body>
    <h1>üîç API„Ç®„É©„ÉºË®∫Êñ≠„ÉÜ„Çπ„Éà</h1>
    <pre id="output"></pre>
    
    <script>
        (async () => {
            const output = document.getElementById('output');
            const log = (msg) => {
                output.textContent += msg + '\n';
            };

            try {
                log('=== „ÉÜ„Çπ„Éà1: „É¶„Éº„Ç∂„ÉºÁôªÈå≤ ===');
                log('Endpoint: POST /api/auth/register');
                log('');
                
                const payload = {
                    nickname: 'DiagTest_' + Date.now(),
                    birthYear: 2000,
                    birthMonth: 1,
                    birthDay: 1
                };
                log('Request Body:');
                log(JSON.stringify(payload, null, 2));
                log('');
                
                const res = await fetch('/api/auth/register', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                log('Response Status: ' + res.status + ' ' + res.statusText);
                log('Response Headers:');
                for (const [key, value] of res.headers) {
                    log('  ' + key + ': ' + value);
                }
                log('');
                
                const data = await res.json();
                log('Response Body:');
                log(JSON.stringify(data, null, 2));
                log('');
                
                if (res.ok) {
                    log('‚úì ÊàêÂäü: „É¶„Éº„Ç∂„ÉºID = ' + data.userId);
                } else {
                    log('‚úó „Ç®„É©„Éº: ' + (data.error || 'Unknown error'));
                }
                
                log('');
                log('=== „ÉÜ„Çπ„Éà2: „Éá„Éº„Çø„Éô„Éº„ÇπÊé•Á∂öÁ¢∫Ë™ç ===');
                log('');
                
                // „Çà„ÇäË©≥Á¥∞„Å™„Ç®„É©„Éº„ÇíÁ¢∫Ë™ç„Åô„Çã„Åü„ÇÅ„ÄÅÂà•„ÅÆ„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà„Çí„ÉÜ„Çπ„Éà
                log('Endpoint: GET /api/admin/users');
                log('');
                
                const usersRes = await fetch('/api/admin/users', {
                    method: 'GET',
                    headers: { 'Content-Type': 'application/json' }
                });
                
                log('Response Status: ' + usersRes.status + ' ' + usersRes.statusText);
                log('');
                
                const usersData = await usersRes.json();
                log('Response Body:');
                log(JSON.stringify(usersData, null, 2));
                
            } catch (error) {
                log('');
                log('‚úó „Ç®„É©„ÉºÁô∫Áîü:');
                log('  Message: ' + error.message);
                log('  Stack: ' + error.stack);
            }
        })();
    </script>
</body>
</html>
