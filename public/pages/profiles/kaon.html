<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>三崎花音 - 運命の扉</title>
    <link rel="stylesheet" href="../../css/styles.css">
</head>
<body class="detail-page-new-v2">
    <div class="background-particles">
        <div class="floating-particles"></div>
    </div>

    <div class="detail-content-wrapper">
        <div class="name-section-v2">
            <h1>三崎花音<span class="name-subtitle">（みさき かおん）</span></h1>
            <div class="name-divider"></div>
            <p style="font-size: 16px; color: #d4c4e8; margin-top: 15px; opacity: 0.9;">1977年4月10日（おひつじ座・巳年） | 沖縄県石垣市出身</p>
            <p style="font-size: 14px; color: #b8a8d8; margin-top: 8px; opacity: 0.8;">天体音響心理鑑定士（アストロ・ヴォイス・アナリスト）</p>
        </div>

            <div class="image-container">
            <img src="../../photo/kaon.png" alt="三崎花音" class="clickable-image" id="mainImage">
            <p class="image-hint">画像をクリックして拡大表示</p>
            <div class="button-section-v2">
                <a href="back.html?character=kaon" class="consult-button">三崎花音に相談</a>
            </div>
        </div>

        <div class="content-sections">
            <div class="profile-section-v2">
                <h2>プロフィール</h2>
                <p>
                    沖縄の聖域で代々続く「琉球ユタ」の家系に生まれ、幼少期より人の感情や嘘を「音」として聞き分ける特異な感性を発揮する。その鋭すぎる直感力を制御し、論理的な知恵へと昇華させるため、若くして欧州へ渡り西洋占星術の奥義を習得。帰国後は、ユタの血筋がもたらす「共鳴力」と、西洋占星術、そして行動心理学を融合させた独自の鑑定スタイルを確立する。<br><br>
                    かつては「未来予知」の的中率でも名を馳せたが、現在は「未来を当てることより、その人の魂を調律すること」に重きを置いている。相談者が一言発するだけで、その声の周波数から現在のホロスコープとの不協和音を聞き取り、本人さえ気づいていない「隠された本音」を鮮やかに解き明かす。その驚異的な洞察力は、政財界や著名人からも「三崎の前では嘘をつけない」と畏怖されるほどである。<br><br>
                    ギャンブルや数字の予想といった、魂の成長を伴わない鑑定も可能であるが、あえてその能力を「愛と自己変革」のためにのみ捧げている。特に複雑な恋愛関係における鑑定では、心理学的なアプローチと星の配置から、相手の心の「鍵」を見つけ出すことに長けているが、相談者の人生にとって毒となる道へは決して手を貸さない。<br><br>
                    「未来は決まっているものではないわ。あなたの声が、次の運命を奏でているのよ……。」<br><br>
                    成熟した女性としての深い包容力と、逃げ場をなくすほど鋭い鑑定で、今もなお多くの迷える魂を救い続けている。
                </p>
            </div>
            <div class="button-section-v2">
                <a href="back.html?character=kaon" class="consult-button">三崎花音に相談</a>
            </div>

            <div class="message-section-v2">
                <div class="quote-mark">"</div>
                <p>
                    私の能力は未来予知であり、あまりにも確実に人の未来を読めるところから、それを悪用しようとして私に相談をする方が後を絶ちません。<br><br>
                    宝くじの当選番号やギャンブルに関しては、確実に当選させることが可能ですが、それを相談者に持ちかけられても絶対に断りしておりますので、そのような内容の相談は決してしないようにしてください。<br><br>
                    また、不倫相手の恋人がいて、その相手の現在の家庭の不和を持ちかけようとするような悪意のある相談者が目立っております。<br><br>
                    第三者の力により未来を変えることは、それが人生において良き方向に向けるためのものであり、そして誰かを不幸にしては決していけないのです。そのことを十分に心がけて相談してください。
                </p>
                <div class="quote-mark quote-mark-end">"</div>
            </div>
            <div class="button-section-v2">
                <a href="back.html?character=kaon" class="consult-button">三崎花音に相談</a>
            </div>
            <div class="profile-section-v2" style="margin-top: 30px;">
                <h2>～番組より～</h2>
                <p>
                    未来予知の能力により、過去に高額の宝くじの当選番号を当てたことでマスコミには話題になった先生ですが、そのようなことを鑑定で相談者にすることは決してありません。<br><br>
                    しかし、その能力の素晴らしさは、番組も重々承知をしております。<br><br>
                    先生のおっしゃるように自分の未来を知ることが本当に良いことかどうかをしっかり考えながらご相談ください。この先生の能力は時には相談する人を悪い方向に導く可能性もあります。番組としてはそのようなことを望みませんので、くれぐれも自制心を持ってご相談ください。
                </p>
            </div>
            <div class="button-section-v2">
                <a href="back.html?character=kaon" class="consult-button">鑑定に進む</a>
            </div>

            <div class="button-section-v2 back-button-section">
                <a href="../main.html" class="back-button">鑑定士一覧に戻る</a>
            </div>
        </div>
    </div>

    <!-- 全画面画像モーダル -->
    <div class="image-modal" id="imageModal">
        <span class="close-modal" id="closeModal">&times;</span>
        <img src="../../photo/kaon.png" alt="三崎花音" class="modal-image" id="modalImage">
    </div>

    <!-- スマートフォン用フッターボタン -->
    <div class="mobile-footer-button">
        <a href="back.html?character=kaon" class="consult-button">三崎花音に相談</a>
    </div>

    <script src="../../js/auth-state.js"></script>
    <script>
        // #region agent log
        fetch('http://127.0.0.1:7242/ingest/a12743d9-c317-4acb-a94d-a526630eb213',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'kaon.html:75',message:'プロフィールページ読み込み',data:{url:window.location.href,search:window.location.search},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'D'})}).catch(()=>{});
        // #endregion
        
        // ログイン状態をチェックして「相談する」ボタンのリンクを設定
        (function() {
            'use strict';
            
            // AuthStateを初期化
            if (window.AuthState && typeof window.AuthState.init === 'function') {
                window.AuthState.init();
            }
            
            const character = 'kaon';
            const chatUrl = `../chat/chat.html?character=${character}`;
            const registerUrl = `../auth/register.html?character=${character}&redirect=${encodeURIComponent(chatUrl)}`;
            
            // すべての「相談する」ボタンを取得
            const consultButtons = document.querySelectorAll('a[href*="back.html"], a.consult-button');
            
            consultButtons.forEach(button => {
                // ログイン状態をチェック
                // 【新仕様】userTokenは不要。session_idで識別する
                const isLoggedIn = window.AuthState && window.AuthState.isRegistered ? window.AuthState.isRegistered() : Boolean(localStorage.getItem('guestSessionId'));
                
                if (isLoggedIn) {
                    // ログイン済みの場合は直接チャット画面へ
                    button.href = chatUrl;
                } else {
                    // 未ログインの場合は登録画面へ
                    button.href = registerUrl;
                }
            });
        })();
        
        // パーティクルエフェクト
        function createFloatingParticle() {
            const container = document.querySelector('.floating-particles');
            if (!container) return;
            
            const particle = document.createElement('div');
            particle.className = 'particle-item';
            
            const size = Math.random() * 3 + 1;
            const x = Math.random() * 100;
            const duration = Math.random() * 15 + 10;
            const delay = Math.random() * 2;
            
            particle.style.width = size + 'px';
            particle.style.height = size + 'px';
            particle.style.left = x + '%';
            particle.style.animationDuration = duration + 's';
            particle.style.animationDelay = delay + 's';
            
            container.appendChild(particle);
            
            setTimeout(() => {
                particle.remove();
            }, (duration + delay) * 1000);
        }

        setInterval(createFloatingParticle, 1500);

        // 画像クリックでモーダル表示
        const mainImage = document.getElementById('mainImage');
        const imageModal = document.getElementById('imageModal');
        const modalImage = document.getElementById('modalImage');
        const closeModal = document.getElementById('closeModal');

        mainImage.addEventListener('click', () => {
            imageModal.classList.add('active');
            document.body.style.overflow = 'hidden';
        });

        closeModal.addEventListener('click', () => {
            imageModal.classList.remove('active');
            document.body.style.overflow = '';
        });

        imageModal.addEventListener('click', (e) => {
            if (e.target === imageModal) {
                imageModal.classList.remove('active');
                document.body.style.overflow = '';
            }
        });

        // ESCキーで閉じる
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && imageModal.classList.contains('active')) {
                imageModal.classList.remove('active');
                document.body.style.overflow = '';
            }
        });

        // 画像のグローエフェクト
        let glowIntensity = 0.4;
        let glowDirection = 1;
        
        setInterval(() => {
            glowIntensity += glowDirection * 0.02;
            if (glowIntensity >= 0.8) {
                glowIntensity = 0.8;
                glowDirection = -1;
            } else if (glowIntensity <= 0.4) {
                glowIntensity = 0.4;
                glowDirection = 1;
            }
            mainImage.style.boxShadow = `0 0 25px rgba(138, 43, 226, ${glowIntensity}), 0 10px 40px rgba(138, 43, 226, ${glowIntensity * 0.5})`;
        }, 100);
        
        // #region agent log
        document.querySelectorAll('a[href*="back.html"]').forEach((btn) => {
            btn.addEventListener('click', (e) => {
                fetch('http://127.0.0.1:7242/ingest/a12743d9-c317-4acb-a94d-a526630eb213',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'kaon.html:click',message:'鑑定に進むボタンクリック',data:{href:btn.href,text:btn.textContent},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'C'})}).catch(()=>{});
            });
        });
        // #endregion
    </script>
</body>
</html>
